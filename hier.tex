\documentclass[main.tex]{subfiles}
\begin{document}
\section{The Completion}
\label{S:completion}
%
%                     PI L
%

\subsection{The $\Pi$-Extension}
Let $\vs{V}{L}\varphi{E}$ be a valuation system.
Before we try to extend $\vs{V}{L}\varphi{E}$ to a complete
valuation system, 
we study whether $\vs{V}{L}\varphi{E}$
can be extended to a $\Pi$-complete valuation system.

\begin{dfn}
\label{D:PiL}
$\ \Pi L \ \eqdf \ \{ 
\bw_n a_n \colon \ \text{$\varphi$-convergent }
 a_1\geq a_2 \geq\dotsb \text{ from $L$} \}.$
\end{dfn}
%
%                  Pi(L) is lattice
%
\begin{lem}
\label{L:PiL-lattice}
$\Pi L$ is a sublattice of~$V$,
and $L$ is a sublattice of~$\Pi L$.
\end{lem}
\begin{proof}
We first prove that~$\Pi L$ is a sublattice of~$V$.
Let $a,b\in \Pi L$ be given;
we need to prove that $a\wedge b \in \Pi L$
and $a \vee b \in \Pi L$.
Choose $\varphi$-convergent 
$a_1 \geq a_2 \geq\dotsb$ and
$b_1 \geq b_2 \geq\dotsb$
with $a = \bw_n a_n$ and  $b=\bw_n b_n$.
Then $a_1 \wedge b_1 \geq a_2 \wedge b_2 \geq \dotsb$
is $\varphi$-convergent by Proposition~\ref{P:R-main},
and we have $\bw_n a_n \wedge b_n = a\wedge b$.
Hence $a\wedge b \in \Pi L$.
Similarly,
$a_1 \vee b_1 \geq a_2 \vee b_2 \geq \dotsb$
is $\varphi$-convergent by Proposition~\ref{P:R-main}
and
using $\sigma$-distributivity 
one can prove that $a \vee b  =\bw_n a_n \vee b_n$.
Hence $a\vee b \in \Pi L$.

To prove that~$L$ is a sublattice of~$\Pi L$,
we first note that~$L$ is a subset of~$\Pi L$.
Now,
since both $L$ and~$\Pi L$ are sublattices of~$V$,
and $L$ is a subset of~$\Pi L$,
we know that $L$ must be a sublattice of~$\Pi L$.
\end{proof}
\begin{rem}
In the proof of Lemma~\ref{L:PiL-lattice},
we have used the fact that~$V$ is $\sigma$-distrubutive
and the fact that~$E$ is $R$-complete
(via Proposition~\ref{P:R-main}).
\end{rem}

\begin{dfn}
\label{D:Pi-extendible}
We say~$\varphi$ is \keyword{$\Pi$-extendible}
if there is a valuation $\psi \colon \Pi L \ra E$ with
\begin{equation*}
\psi ( \bw_n a_n )
\ =\ 
\bw_n \varphi(a_n) 
\qquad
\text{ for all $\varphi$-convergent }
a_1 \geq a_2 \geq \dotsb.
\end{equation*}
Clearly,
there can be at most one such map~$\psi$;
if it exists, we denote it by 
\begin{equation*}
\Pi \varphi\colon \Pi L \ra E.
\end{equation*}
Finally,
note that if $\varphi$ is $\Pi$-extendible,
then $\Pi\varphi$ extends $\varphi$ (hence the name).
\end{dfn}
%
%                  PI EXTENDIBLE IMPLIES PI COMPLETE
%
\begin{lem}
\label{L:Pi-complete}
If $\varphi$ is $\Pi$-extendible,
then $\vs{V}{\Pi L}{\Pi\varphi}{E}$ is $\Pi$-complete.
\end{lem}
\begin{proof}
Let $a^1 \geq a^2 \geq \dotsb $ from $\Pi L$
be given and suppose  $\bw_n \Pi \varphi (a^n)$ exists;
we need to prove that $\bw_n a^n \in \Pi L$
and $\Pi\varphi(\bw_n a_n) = \bw_n \Pi \varphi(a_n )$.
To begin, write
$a^n = \bw_n a^n_m$
for each~$n$,
where $a^n_1 \geq a^n_2 \geq \dotsb$
is $\varphi$-convergent, and define
\begin{equation*}
b_i \ \eqdf\ \bw\{\,a^n_m\colon n,m\leq i \,\}.
\end{equation*}
Then $b_1 \geq b_2 \geq \dotsb$
and $\bw_n b_n = \bw_n a^n$.
Recall that  $\bw_n \Pi\varphi(a^n)$
exists.
We claim that $\bw_n \Pi\varphi(a^n)$
is the infimum of $\varphi b_1 \geq \varphi b_2 \geq \dotsb$.
If we can prove this, we are done.
Indeed,
then $b_1 \geq b_2 \geq\dotsb$ is $\varphi$-convergent,
so $\bw_n a^n = \bw_n b_n \in \Pi L$,
and
\begin{alignat*}{3}
\Pi\varphi( \bw_n a^n ) \ &=\  \Pi\varphi( \bw_n b_n )
 \qquad&& \text{since $\bw_n a^n = \bw_n b_n$}, \\
&=\ \bw_n \varphi (b_n)  
  && \text{since $\varphi$ is $\Pi$-extendible,}\\
&=\ \bw_n \Pi\varphi(a^n) 
  && \text{by the claim.}
\end{alignat*}

For each~$i$,
we have $b_i \geq \bw_{n\leq i} a^n = a^i$,
so $\varphi(b_i) = \Pi\varphi(b_i) \geq \Pi\varphi(a^i)$.
Hence we see that
$\bw_n \Pi\varphi(a^n)$ is a lower bound of
$\varphi(b_1)\geq \varphi(b_2) \geq \dotsb$.

On the other hand:
Let $\ell$ be a lower bound of $\varphi b_1 \geq \varphi b_2 \geq \dotsb$;
we need to prove that $\ell \leq \bw_n \Pi\varphi(a^n)$.
For all~$n$ and~$m$,
we have $a_m^n \geq b_{n\vee m}$
and so $\varphi(a_m^n) \geq \varphi(b_{n\vee m}) \geq \ell$.
Hence $\Pi\varphi(a^n) = \bw_m \varphi(a_m^n) \geq \ell$
for all~$n$.
So $\bw_n \Pi\varphi(a^n) \geq \ell$.

So $\bw_n \Pi\varphi(a^n)$ is the infimum of 
$\varphi b_1 \geq \varphi b_2 \geq \dotsb$,
and we are done.
\end{proof}
%
%                  MINIMALITY OF PI L
%
\begin{lem}
\label{L:Pi-minimal}
Let $C$ be a sublattice of~$V$.
Let $\psi\colon C\ra E$ be a valuation.
Assume
\begin{equation*}
\psi\text{ extends }\varphi
\qquad\text{and}\qquad
\vs{V}{C}\psi{E}\ \text{ is $\Pi$-complete.}
\end{equation*}
Then $\varphi$ is $\Pi$-extendible and
$\psi$ extends $\Pi\varphi$.
\end{lem}
\begin{proof}
Let $\varphi$-convergent $a_1 \geq a_2 \geq \dotsb$
be given.
We prove that
\begin{equation}
\label{eq:L:PiL-minimal}
\bw_n a_n \in C\qquad\text{and}\qquad \psi (\bw_n a_n) = \bw_n \varphi(a_n).
\end{equation}
We know that $\bw_n \varphi (a_n)$ exists
(since $a_1 \geq a_2 \geq \dotsb$ is $\varphi$-convergent),
and that $\varphi(a_n)= \psi(a_n)$
(since $\psi$ extends $\varphi$).
So $\bw_n \psi(a_n)$ exists too.
Hence $a_1 \geq a_2 \geq \dotsb$ is $\psi$-convergent.
Because $\vs{V}{C}\psi{E}$ is $\Pi$-complete
this implies that $\bw_n a_n \in C$ and 
$\psi (\bw_n a_n) = \bw_n \psi(a_n)$
(see Definition~\ref{D:system-complete2}\ref{D:system-complete2-pi}).
Hence we have proven Equation~\eqref{eq:L:PiL-minimal}.

Equation~\eqref{eq:L:PiL-minimal} implies that $\Pi L \subseteq C$.
So in order to prove that $\varphi$
is $\Pi$-extendible,
let us consider the valuation $\mu \eqdf \psi \,|\,\Pi L$.
We must prove that
$\mu(\bw_n a_n) = \bw_n \varphi(a_n)$
for every $\varphi$-convergent $a_1 \geq a_2 \geq \dotsb$
(see Definition~\ref{D:Pi-extendible}),
but this follows immediately from Equation~\eqref{eq:L:PiL-minimal}.
Hence $\varphi$ is $\Pi$-extendible.

Finally,
since we know that~$\varphi$ is $\Pi$-extendible,
we can talk about~$\Pi\varphi$,
and write the second part of
Equation~\eqref{eq:L:PiL-minimal}
as $\psi(\bw_n a_n) = \Pi \varphi(\bw_n a_n)$.
Hence $\psi$ extends $\Pi\varphi$.
\end{proof}
%
%                  MONOTONICITY OF PI
%
\begin{lem}
\label{L:Pi-monotonous}
Let $\vs{V}{K}\psi{E}$ be
a valuation system
such that $\psi$ extends $\varphi$.\\
Suppose that $\psi$ is $\Pi$-extendible.
Then $\varphi$ is $\Pi$-extendible
and  $\Pi\psi$ extends $\Pi\varphi$.
\end{lem}
\begin{proof}
Note that $\Pi\psi$ extends $\varphi$,
and $\vs{V}{\Pi K}{\Pi \psi}{E}$
is $\Pi$-complete (see Lemma~\ref{L:Pi-complete}).
So Lemma~\ref{L:Pi-minimal}
implies that
$\varphi$ is $\Pi$-extendible
and $\Pi\psi$ extends $\Pi\varphi$.
\end{proof}
%
%                  PI EXTENDIBLE IFF PI-CONTINUOUS
%
\begin{lem}
\label{L:Pi-continuity}
$\varphi$ is $\Pi$-extendible
if and only if  $\varphi$
has the following property.
\begin{equation}
\label{eq:Pi-cont}
\left[ \quad
\begin{minipage}{.7\columnwidth}
For every $b\in L$ and $\varphi$-convergent 
 $a_1 \geq a_2 \geq \dotsb$,
we have
\begin{equation*}
\bw_n a_n \leq b
\quad\implies\quad
\bw_n \varphi (a_n) \leq \varphi(b).
\end{equation*}
\end{minipage}
\right.
\end{equation}
\end{lem}
\begin{proof}
$\implies$\ 
Suppose $\varphi$ is $\Pi$-extendible.
Then $\varphi$ has Property~\eqref{eq:Pi-cont},
because if $b\in L$ and $\varphi$-convergent $a_1 \geq a_2 \geq \dotsb$
with $\bw_n a_n \leq b$ are given,
then we have
\begin{equation*}
\bw_n \varphi(a_n) 
\ =\ 
\Pi\varphi(\bw_n a_n)
\ \leq\ 
\varphi(b).
\end{equation*}

\noindent$\Longleftarrow$\ 
Suppose~$\varphi$ has Property~\eqref{eq:Pi-cont};
we prove $\varphi$ is $\Pi$-extendible.
We claim that
\begin{equation}
\label{eq:Piphi-order-preserving}
\bw_n a_n \ \leq\ \bw_n b_n 
\quad\implies\quad
\bw_n \varphi(a_n) \ \leq\ \bw_n \varphi(b_n),
\end{equation}
where $a_1 \geq a_2 \geq \dotsb$ and $b_1 \geq b_2 \geq \dotsb$
are $\varphi$-convergent.

Indeed,
if $\bw_n a_n \leq \bw_n b_n$,
then $\bw_n a_n \leq b_m$ for all~$m$,
so $\bw_n \varphi(a_n) \leq \varphi(b_m)$ for all~$m$
(by Property~\eqref{eq:Pi-cont}),
and hence $\bw_n \varphi(a_n) \leq \bw_n \varphi(b_m)$.

Equation~\eqref{eq:Piphi-order-preserving} implies that
 $\bw_n a_n = \bw_n b_n \implies \bw_n\varphi(a_n) = \bw_n \varphi(b_n)$,
so there is a unique map $\psi\colon \Pi L \ra E$ such that
\begin{equation*}
\psi(\bw_n a_n) \ =\ \bw_n \varphi(a_n)
\qquad
\text{ for all $\varphi$-convergent }a_1 \geq a_2 \geq \dotsb.
\end{equation*}
In fact, 
Equation~\eqref{eq:Piphi-order-preserving}
also implies that~$\psi$ is order preserving.

To prove that~$\varphi$ is $\Pi$-extendible
(see Definition~\ref{D:Pi-extendible}),
it suffices to show that~$\psi$ is a valuation.
For this,
it remains to be shown that~$\psi$ is modular
(see Definition~\ref{D:val}).

Let $a,b\in \Pi L$ be given; 
we need to prove $\psi(a\wedge b) + \psi(a\vee b)= \psi(a)+\psi(b)$.
Write  $a = \bw_n a_n$ and $b = \bw_n b_n$
where 
 $a_1 \geq a_2 \geq \dotsb$ and $b_1 \geq b_2 \geq \dotsb$
are $\varphi$-convergent sequences.
We have
\begin{alignat*}{3}
\varphi(a\wedge b) + \varphi(a \vee b) 
\ &=\ \psi(\bw_n a_n \wedge \bw_n b_n) + \psi(\bw_n a_n \vee \bw_n b_n) \\
\ &=\ \psi(\bw_n a_n \wedge b_n) + \psi(\bw a_n \vee b_n) \\
  &=\ \bw_n \varphi(a_n \wedge b_n) + \bw_n \varphi(\bw a_n \vee b_n) \\
  &=\ \bw_n \varphi(a_n \wedge b_n) + \varphi(a_n \vee b_n) \\
  &=\ \bw_n \varphi(a_n) + \varphi(b_n) \\
  &=\ \psi(\bw_n a_n) + \psi(\bw_n b_n).
\end{alignat*}
Hence $\psi$ is modular, which completes the proof
that $\varphi$ is $\Pi$-extendible.
\end{proof}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%j%
%
%                  THE HIERARCHY OF EXTENSIONS
%
\subsection{The Minimal Complete Extension} $\,$\\
\label{SS:hierarchy}
Let $\vs{V}{L}\varphi{E}$ 
and $\vs{V}{C}\psi{E}$
be valuation systems
such that 
\begin{equation*}
\text{$\psi$ extends~$\varphi$}
\qquad\text{and}\qquad
\text{$\psi$ is complete.}
\end{equation*}
Then $\vs{V}{C}{\psi}{E}$ is also $\Pi$-complete
(see Definition~\ref{D:system-complete2}).
Hence Lemma~\ref{L:Pi-minimal}
implies that $\varphi$ is $\Pi$-extendible 
and that $\psi$ extends  $\Pi \varphi$.

Thus, loosely speaking, $\Pi\varphi$ is the minimal extension of~$\varphi$
which is $\Pi$-complete.
In this subsection,
we identify the minimal extension~$\overline \varphi$ of~$\varphi$
which is complete.
We tackle this problem
in order to familiarize
the reader with the notions needed to define
``$\vs{V}{L}{\varphi}{E}$ is extendible''
(see Definition~\ref{D:extendible}).
These notions, which we introduce
 rather informally in this subsection,
will be defined rigorously and in a more general setting later on.

Let us begin. Note that
$\vs{V}{C}{\psi}{E}$ is also $\Sigma$-complete.
Hence $\varphi$ is $\Sigma$-extendible,
and $\psi$ extends $\Sigma\varphi$.
So we have the following situation.
\begin{equation*}
\text{$\psi$ extends~$\Pi \varphi$ and~$\Sigma\varphi$}
\qquad\text{and}\qquad
\text{$\vs{V}{C}{\psi}{E}$ is complete.}
\end{equation*}

By similar reasoning,
we see that $\Pi\varphi$ is $\Sigma$-extendible,
and that $\Sigma\varphi$ is $\Pi$-extendible
and that~$\psi$ extends both $\Sigma\Pi\varphi$ and $\Pi\Sigma\varphi$.
(Note that $\Pi(\Pi\varphi) =  \Pi\varphi$.)
So we have the following situation.
\begin{equation*}
\text{$\psi$ extends~$\Sigma\Pi \varphi$ and~$\Pi\Sigma\varphi$}
\qquad\text{and}\qquad
\text{$\vs{V}{C}{\psi}{E}$ is complete.}
\end{equation*}

Of course,
we can continue this proces.
More formally,
the clauses
\begin{alignat*}{5}
\Pi_{n+1} \varphi \, &=\, \Pi(\Sigma_n\varphi) &\qquad\quad
\Sigma_{n+1} \varphi \,&=\, \Sigma(\Pi_n\varphi) &\qquad\quad 
\Pi_0 \varphi \,&=\, \varphi \,&&=\, \Sigma_0 \varphi \\
\Pi_{n+1} L \, &=\, \Pi(\Sigma_n L) &\qquad\quad
\Sigma_{n+1} L \, &=\, \Sigma(\Pi_n L) &\qquad
\Pi_0 L \,&=\, L \,&&=\, \Sigma_0 L,
\end{alignat*}
give us for every~$n$ valuations
$\vs{V}{\Pi_n L}{\Pi_n\varphi}{E}$ and
$\vs{V}{\Sigma_n L}{\Sigma_n\varphi}{E}$.

Note that $\Pi\varphi$ extends $\varphi$.
Hence $\Sigma_2\varphi$ extends $\Sigma \varphi$ by
Lemma~\ref{L:Pi-monotonous}.
Hence $\Pi_3\varphi$ extends $\Pi_2 \varphi$.
Etcetera.
Similarly,
$\Sigma\varphi$ extends~$\varphi$,
so $\Pi_2 \varphi$ extends~$\Pi\varphi$,
and so on.

The hierarchy which we have obtained 
is shown in the following diagram.
\begin{equation*}
\xymatrix @=10pt {
& \Sigma\varphi \ar @{-} [rr] \ar @{-} [rrdd]
&& \Sigma_2\varphi  \ar @{-} [rr] \ar @{-} [rrdd]
&& \Sigma_3\varphi  \ar @{-} [rr] \ar @{-} [rrdd]
&& \Sigma_4\varphi  \ar @{-} [rr] \ar @{-} [rrdd]
&& \Sigma_5 \varphi  \ar @{-} [r]\ar @{-} [rd]
&& \dotsb
\\  
\varphi \ar @{-} [ru] \ar @{-} [rd] 
&&&&&&&&&&&\dotsb\\
& \Pi\varphi \ar @{-} [rr] \ar @{-} [rruu]
&& \Pi_2\varphi \ar @{-} [rr]\ar @{-} [rruu]
&& \Pi_3\varphi \ar @{-} [rr]\ar @{-} [rruu]
&& \Pi_4\varphi \ar @{-} [rr]\ar @{-} [rruu]
&& \Pi_5 \varphi \ar @{-} [r] \ar @{-} [ru]
&& \dotsb
}
\end{equation*}
We say that the \emph{hierarchy collapsed at~$Q$}, where $Q  \in 
\{\,  L,\, \Pi_1 L, \, \Sigma_1 L,\,\Pi_2 L,\,\dotsc\,\}$, if
\begin{equation*}
\Pi( Q ) \,=\, Q \,=\, \Sigma(Q).
\end{equation*}
In that case, let~$q\colon Q\ra E$ be the associated valuation
(either $\Pi_n\varphi$ or $\Sigma_n\varphi$ for some~$n$).
Then $\vs{V}{Q}{q}{E}$ is complete,
since it is both $\Pi$-complete 
and $\Sigma$-complete.

Note that the definition of $\Pi_n \varphi$
and $\Sigma_n \varphi$ does not depend
on which complete extension~$\psi$ of~$\varphi$ is given,
only on the fact that such~$\psi$ exists.
In particular,
if $\vs{V}{C'}{\psi'}{E}$ is any complete valuation system
such that~$\psi'$ extends~$\varphi$,
then $\psi'$ extends~$\Pi_n L$ and $\Sigma_n L$.
In particular,
such~$\psi'$ extends~$q$.
Hence~$q$ is the smallest complete extension of~$\varphi$ we sought.

However,
in general the hierarchy need not have collapsed at
any $\Pi_n L$ or~$\Sigma_n L$,
as we will show lateron \todo{add reference}.
So to find our minimal complete extension of~$\varphi$,
we need to push forwards.
To this end, consider the sets $\Pi_\omega L$
and $\Sigma_\omega L$ given by
\begin{equation*}
\Pi_\omega L \,\eqdf\,\textstyle{\bigcup_n}\, \Pi_n L
\qquad\text{and}\qquad
\Sigma_\omega L \,\eqdf\, \textstyle{\bigcup_n}\, \Sigma_n L.
\end{equation*}
Since $\Pi_{n} L \subseteq \Sigma_{n+1} L$
and $\Sigma_{n} L \subseteq \Pi_{n+1}L$ for all~$n$,
we see that $\Pi_\omega L = \Sigma_\omega L$.

Now,
since $\Pi_n\varphi$ extends $\Pi_m\varphi$
for $n\geq m$,
there is a unique map~$\Pi_\omega \varphi\colon \Pi_\omega L \ra E$
which extends all~$\Pi_n \varphi$.
One can easily see that $\vs{V}{\Pi_\omega L}{\Pi_\omega\varphi}{E}$
is a valuation system.
Similarly, there is a unique map 
$\Sigma_\omega \varphi \colon \Sigma_\omega L \ra E$
which extends all~$\Sigma_n\varphi$.
Then $\vs{V}{\Sigma_\omega L}{\Sigma_\omega\varphi}{E}$
is a valuation system.

Since $\Pi_{n+1}\varphi$ extends $\Sigma_{n}\varphi$
for all~$n$, one sees that $\Pi_\omega\varphi = \Sigma_\omega\varphi$.

Again, the hierarchy might have collapsed at~$\Pi_\omega L$,
i.e.,
\begin{equation*}
\Pi(\Pi_\omega L ) \,=\, \Pi_\omega L \,=\, \Sigma(\Pi_\omega L).
\end{equation*}
In that case $\Pi_\omega\varphi$ the minimal completion of~$\varphi$
we sought.

However,
again the hierarchy
might not have collapsed at~$\Pi_\omega L$,
so we consider the valuations
 $\Pi_{\omega+n}\varphi\eqdf\Pi_{n} (\Pi_\omega \varphi)$
and $\Sigma_{\omega+n}\varphi \eqdf \Sigma_{n}(\Pi_\omega\varphi)$.

\begin{equation*}
\xymatrix @=10pt {
& \Sigma\varphi \ar @{-} [rr] \ar @{-} [rrdd]
&& \Sigma_2 \varphi  \ar @{-} [r]\ar @{-} [rd]
&& \dotsb
& \Sigma_{\omega} \varphi \ar @{-} [rr] \ar @{-} [rrdd]
                          \ar @{=} [dd]
&& \Sigma_{\omega+1}\varphi \ar @{-} [rr] \ar @{-} [rrdd]
&& \Sigma_{\omega+2} \varphi  \ar @{-} [r]\ar @{-} [rd]
&& \dotsb
\\  
\varphi \ar @{-} [ru] \ar @{-} [rd] 
&&&&&\dotsb
&&
&&&&&\dotsb\\
& \Pi\varphi \ar @{-} [rr] \ar @{-} [rruu]
&& \Pi_{2} \varphi \ar @{-} [r] \ar @{-} [ru]
&& \dotsb
& \Pi_{\omega}\varphi \ar @{-} [rr] \ar @{-} [rruu]
&& \Pi_{\omega+1}\varphi \ar @{-} [rr] \ar @{-} [rruu]
&& \Pi_{\omega+2} \varphi \ar @{-} [r] \ar @{-} [ru]
&& \dotsb
}
\end{equation*}
With induction on ordinal numbers,
we can repeat this process endlessly.
However, 
the collapse of the hierarchy
can not be postponed indefinitely.

More formally,
let $\overline{L}\eqdf \{\, c\in C\colon
\exists\alpha[c\in \Pi_\alpha L]\, \}$.
Then we have $\Pi_\alpha L \subseteq \overline L$
for every~$\alpha$.
We want to prove that~$\Pi_\alpha L=\overline L$
for some~$\alpha$.
Define
\begin{equation*}
\alpha(c) \ =\ \min\, \{\  \beta\colon\   c\in \Pi_\beta L \ \}
\qquad\qquad(c\in \overline L).
\end{equation*}
Then the set of ordinal numbers $\{\,\alpha(c)\colon\,c\in \overline L\,\}$
has a supremum, say~$\xi$.
We have 
\begin{equation*}
c\in \Pi_{\alpha(c)} L \ \subseteq \ \Pi_\xi L
\qquad\qquad
(c\in \overline L).
\end{equation*}
So $\overline L \subseteq \Pi_{\xi} L$.
But we alread had $\Pi_{\xi}L\subseteq \overline L$.
Hence $\Pi_{\xi} L = \overline L$.

We claim that the hierarchy has collapsed at~$\xi$,
i.e., 
\begin{equation*}
\Pi(\Pi_\xi L) \,=\, \Pi_\xi L \,=\, \Sigma(\Pi_\xi L).
\end{equation*}
Indeed,
we have 
\begin{equation*}
\Pi_\xi L \ \subseteq\ \Sigma(\Pi_\xi L ) \ \subseteq \ \overline L
\ = \ \Pi_\xi L.
\end{equation*}
So $\Sigma(\Pi_\xi L) = \Pi_\xi L$.
Similarly, $\Pi_\xi L = \Pi(\Pi_\xi L)$.

One can easily verify that
$\overline\varphi \eqdf \Pi_\xi \varphi$
is the smallest complete  extension of~$\varphi$.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%                  THE NEED FOR THE HIERARCHY
%
\subsection{The Borel Hierarchy Theorem}$\,$\\
\subsubsection{Introduction}$\,$\\
Before we continue our study of the hierarchy introduced in the
Subsection~\ref{SS:hierarchy}, let us take a step back and wonder: 
 is this all --- the endless hierarchy --- neccesary?

Indeed,
using the terminology of Subsection~\ref{SS:hierarchy},
it is not unthinkable
that the hierarchy is always collapsed
at, say $\Sigma_{37} L$.
In that case 
the theory would be much simpler;
we would only need to
use the symbols up to~``$\Sigma_{37}$''.
In particular,
the involvement of the (infinite) ordinal numbers would not be required.

It turns out that we \emph{do} need a large amount of symbols
to desribe the hierarchy.
In this subsection we will give an example
where the hierarchy can only be collaped at~$\Pi_\alpha L$
or at~$\Sigma_\alpha L$
if the ordinal number~$\alpha$ is \emph{uncountable}.

On the bright side,
it does not get worse than this:
we will see 
(in Lemma~\ref{L:aleph1})
that 
the hierarchy is always collapsed at~$\Pi_{\aleph_1} L$,
where~$\aleph_1$
is the set of all countable ordinal numbers,
i.e., the smallest uncountable ordinal number.

Our example involves Borel sets.
Recall that the \emph{Borel subsets}
of a topological space~$X$
(such as~$\R$)
are those subsets one can form using countable intersection
and countable union starting from the open subsets.

Instead of~$\R$,
we  work with the Borel subsets
of the 
 \emph{Baire space},
 $\N^\N$.
In short,
the topology on~$\N^\N$
is the product topology
when~$\N$ is given the discrete toplogy.
To understand these words,
one might look at~\cite{Willard70},
but this is not necessary as we will
give a more direct description of~$\mathcal{T}$
in Subsubsection~\ref{SSS:bhier-open}.

While we could do the following
for~$\R$ as well,
it is much easier for~$\N^\N$.
\begin{nt}
Let $\mathcal{T}$
denote the set of open subsets of~$\N^\N$, \\
and let~$\mathcal{B}$
denote the set of Borel subsets of~$\N^\N$.
\end{nt}
Note that $\mathcal{B}$
is a sublattice of~$\wp(\N^\N)$,
and~$\mathcal{B}$ is a sublattice of~$\mathcal{T}$.

\begin{dfn}
Let $\psi\colon \mathcal{B}\ra \R$
be the map given by, for all~$A\in \mathcal{B}$,
\begin{equation*}
\psi(A)\ =\ 0.
\end{equation*}
\end{dfn}
Then $\psi$ is a valuation,
and we have the following valuation system.
\begin{equation*}
\vs{\wp(\N^\N)}{\mathcal{B}}{\psi}{\R}.
\end{equation*}

\begin{lem}
The valuation $\psi$ is complete with respect to~$\wp(\N^\N)$
(see Def.~\ref{D:system-complete}).
\end{lem}
\begin{proof}
Let $A_1 \supseteq A_2 \supseteq \dotsb$
and $B_1 \subseteq B_2 \subseteq \dotsb$
be a $\psi$-convergent sequences in~$\mathcal{B}$.
To prove that~$\psi$ is complete relative to~$\wp(\N^\N)$
we must show that 
\begin{equation*}
\textstyle 
\bigcap_n A_n \,\in\, \mathcal{B}
\qquad\text{and}\qquad
\bigcup_n B_n \,\in\, \mathcal{B}.
\end{equation*}
This follows immediately by definition of
the Borel subsets.
\end{proof}

\begin{rem}
\label{R:bhier-A}
Let $\mathcal{A}$ be a sublattice of~$\mathcal{B}$
and let
\begin{equation*}
\varphi\colon\mathcal{A}\longrightarrow \R
\end{equation*}
be the restriction of~$\psi$ to~$\mathcal{A}$.
Note that we are in the setting of Subsection~\ref{SS:hierarchy},
\begin{equation*}
\text{$\psi$ extends $\varphi$}
\qquad\text{and}\qquad
\text{$\psi$ is complete}.
\end{equation*}
Using the notation from Subsection~\ref{SS:hierarchy},
let us see what~$\Pi\mathcal{A}$
and $\Sigma\mathcal{A}$ are.

Note that every sequence $A_1 \supseteq A_2 \supseteq \dotsb$
in~$\mathcal{A}$ is $\varphi$-convergent,
as~$\psi$ is constant.
Further, given $A_1,A_2,\dotsc \in \mathcal{A}$,
we have $\bigcap_n A_n = \bigcap_n A_n'$,
where $A_1' \supseteq A_2' \supseteq \dotsb$
are defined by $A_n' = A_1 \cap \dotsb \cap A_n$.
So we see that
\begin{alignat}{3}
\label{eq:bhier-PiA}
\Pi\mathcal{A}\ &=\ 
\{ \ \textstyle{\bigcap_n} A_n\colon\ 
A_1,A_2,\dotsc \,\in\, \mathcal{A}\ \}.
\shortintertext{%
By a similar reasoning it is not hard to see that }
\label{eq:bhier-SigmaA}
\Sigma\mathcal{A}\ &=\ 
\{ \ \textstyle{\bigcup_n} A_n\colon\ 
A_1,A_2,\dotsc \,\in\, \mathcal{A}\ \}.
\end{alignat}
\end{rem}

\subsubsection{Statement of the Borel Hierarchy Theorem}$\,$\\
Let us spend words on where we are headed.
We will define a sublattice~$\mathcal{A}$
of~$\wp(\N^\N)$
in such a way that,
using the notation of Remark~\ref{R:bhier-A},
we have that
$\Sigma \mathcal{A}$
is  precisely the family of open subsets of~$\N^\N$,
while~$\Pi \mathcal{A}$ is the family
of closed subsets of~$\N^\N$.
From this information,
the reader can deduce with induction and the principle
of the excluded middle, that for every ordinal~$\alpha>0$,
and all $A\subseteq\N^\N$, 
\begin{equation*}
A \,\in\, \Pi_\alpha \mathcal{A}
\qquad\iff\qquad
\N^\N\backslash A \,\in\, \Sigma_\alpha \mathcal{A}.
\end{equation*}
The aim of this subsection
is to prove the following statement.
\begin{equation}
\label{eq:hierarchy-theorem}
\left[\quad
\begin{minipage}{.7\columnwidth}
\textbf{%
Let~$\alpha$ be a \emph{countable} ordinal number.\\
There is a set~$S\in \Sigma(\Pi_\alpha\mathcal{A})$
with $S\notin \Pi(\Sigma_\alpha\mathcal{A})$, and \\
there is a set $P\in\Pi(\Sigma_\alpha\mathcal{A})$
with $P\notin \Sigma(\Pi_\alpha\mathcal{A})$.}
\end{minipage}
\right.
\end{equation}
In particular
this means that if the hierarchy has collapsed
at~$\Pi_\alpha\mathcal{A}$
or at~$\Sigma_\alpha\mathcal{A}$
for some ordinal number~$\alpha$
then $\alpha$ must be \emph{uncountable}.

Statement~\eqref{eq:hierarchy-theorem}
is known in descriptive set theory
as the \emph{Borel Hierarchy Theorem}.
We will give a proof of Statement~\eqref{eq:hierarchy-theorem}
 in this subsection that
uses the principle of excluded middle
and is based on a beautiful paper by Veldman~\cite[paragraph 5]{Veldman08}.%
\footnote{
In this paper~\cite{Veldman08},
Veldman (also) gives
a proof of a variant of the Borel Hierarchy Theorem
using Brouwer's Continuity Principle
instead of the principle of excluded middle.}

\subsubsection{Open Subsets of $\N^\N$}$\,$\label{SSS:bhier-open}\\
Before we give a definition of~$\mathcal{A}$,
and start with the proof of Statement~\eqref{eq:hierarchy-theorem}
let us describe the topology~$\mathcal{T}$ 
on the Baire space~$\N^\N$ in more detail.
\begin{dfn}
Given $m,n\in\N$, define $B^m_n$ by
\begin{equation*}
B_n^m\ \eqdf\ \{ \ f\in\N^\N\colon\  f(n) \,=\, m \ \}.
\end{equation*}
\end{dfn}

\begin{rem}
\label{R:bhier-open}
For $A\subseteq \N^\N$,
we have $A\in \mathcal{T}$
if and only if for each $f\in A$
we have,
\begin{equation*}
f\,\in\, B^{m_1}_{n_1} \cap \dotsb \cap B^{m_K}_{n_K} \ \subseteq\ A,
\end{equation*}
for some $K\in\N$ and $m_1,\dotsc,m_K\in\N$
and $n_1,\dotsc,n_K\in\N$.
\end{rem}

We can formulate~Remark~\ref{R:bhier-open} more abstractly
with some notation.
\begin{dfn}
Let $\mathcal{S}$ and $\mathcal{S}_\cap$
be families of subsets of~$\N^\N$
given by
\begin{alignat*}{3}
\mathcal{S} \ &\eqdf\  
\{\ B^m_n \colon \ m,n\in\N \ \} \\
\mathcal{S}_\cap \ &\eqdf \ 
\{ \ S_1 \cap \dotsb\cap S_K\colon\ 
K\in\N,\  S_k\in \mathcal{S}\ \}.
\end{alignat*}
\end{dfn}

\begin{rem}\label{R:bhier-basis}
By Remark~\ref{R:bhier-open},
we see that~$\mathcal{S}$
is a subbasis for the topology~$\mathcal{T}$
on~$\N^\N$,
and we see that~$\mathcal{S}_\cap$ is a basis
for~$\mathcal{T}$.
In particular, we get
\begin{equation}
\label{eq:expression-t}
\mathcal{T}\ =\ 
\{\ \textstyle{\bigcup_n} A_n\colon \ A_1,A_2,\dotsc \in \mathcal{S}_\cap\ \}.
\end{equation}
\end{rem}
\begin{rem}\label{R:bhier-clopen}
Let $m,n\in\N$. Then  $B^m_n \in \mathcal{T}$ by Remark~\ref{R:bhier-basis}.
More suprisingly,
\begin{equation*}
\N^\N \backslash B^m_n\,\in\, \mathcal{T},
\end{equation*}
that is, $B^m_n$ is closed as well.
Indeed, this follows by the following equality.
\begin{equation*}
\N^\N \backslash B^m_n \ =\ 
\textstyle{\bigcup} \{\  B^k_n\colon\ k\in\N,\ k\neq m\ \}.
\end{equation*}

\end{rem}
\subsubsection{Definition of the Sublattice~$\mathcal{A}$ of~$\N^\N$}$\,$\\
Recall that we want to define a sublattice~$\mathcal{A}$
of~$\wp(\N^\N)$
so that $\Sigma \mathcal{A}$
are the open subsets of~$\N^\N$,
while~$\Pi \mathcal{A}$  are the closed subsets
(see Remark~\ref{R:bhier-A}).

Since the elements of~$\mathcal{S}$ are both open and closed,
we let~$\mathcal{A}$ be the sub-Boolean algebra
of~$\wp(\N^\N)$
generated by~$\mathcal{S}$.
More concretely:
\begin{dfn}\label{D:bhier-A}
Let $\mathcal{S}'$, $\mathcal{S}_\cap'$
and $\mathcal{A}$ be the families of subsets of~$\N^\N$ given by
\begin{alignat*}{3}
\mathcal{S}' 
\ &\eqdf\ 
\{\ B^m_n \colon \ m,n\in\N \ \}
\ \cup\ 
\{\ \N^\N\backslash B^m_n \colon \ m,n\in\N \ \}\\
\mathcal{S}_\cap'
\ &\eqdf\ 
\{ \ S_1 \cap \dotsb\cap S_K\colon\ 
K\in\N,\  S_k\in \mathcal{S}'\ \} \\ 
\mathcal{A}
\ &\eqdf\ 
\{ \ T_1 \cup \dotsb\cup T_L\colon\ 
L\in\N,\  T_\ell\in \mathcal{S}_\cap'\ \}.
\end{alignat*}
\end{dfn}
\begin{lem}
The family
$\mathcal{A}$
is a sublattice of~$\wp(\N^\N)$,
and 
\begin{equation*}
\N^\N\backslash A\,\in\,\mathcal{A}
\qquad\iff\qquad
A\,\in\,\mathcal{A}
\end{equation*}
for every~$A\subseteq\N^\N$,
and we have the following equalities.
\begin{alignat*}{3}
\Sigma\mathcal{A} \ &=\ 
\{ \ U\subseteq \N^\N\colon\ U\text{ is open}\ \},\\
\Pi\mathcal{A} \ &=\ 
\{ \ C\subseteq \N^\N\colon \ C\text{ is closed}\ \}.
\end{alignat*}
\end{lem}
\begin{proof}
We leave this to the reader.
\end{proof}


\subsubsection{Encoding the Elements of~$\mathcal{A}$}$\,$\\
Now that we have defined~$\mathcal{A}$,
we can start the proof of
 Statement~\eqref{eq:hierarchy-theorem}.
Maybe the most important idea behind the proof presented here
is that 
we can
encode the  Borel subsets~$\mathcal{B}$ of~$\N^\N$
as elements of~$\N^\N$.

To warm up
let us see how we can encode 
a tuple $a_1 \dotsb a_n$ of natural numbers as a natural number.
We leave it to the reader to 
find a bijection
\begin{equation*}
\left< -,-\right>\colon \ \N\times \N \longrightarrow \N \backslash\{1\}.
\end{equation*}
Let $\N^*$ be the set of tuples on~$\N$.
Given a tuple $a_1\dotsb a_n \in \N^*$, define
\begin{equation*}
\left< a_1a_2  \dotsb a_n \right>\ \eqdf\ 
\left<a_1, \left<a_2,\dotsc \,\left<a_n, 1 \right>\,\dotsb\,\right>\right>.
\end{equation*}
Then the resulting map  $\left<-\right>\colon \N^* \ra \N$
is a bijection.

Let us now encode the elements of~$\mathcal{A}$
 (see Def.~\ref{D:bhier-A}).
Given $k \in \N$, let
\begin{equation*}
 \decode{k}^{\mathcal{S}'}
\ \eqdf \ 
\begin{cases}
\ \N^\N \backslash B^m_n & \text{ if $k\equiv\left<1mn\right>$}, \\
\ B^m_n & \text{ if $k\equiv\left<2mn\right>$}, \\
\ \varnothing &\text{ otherwise.}
\end{cases}
\end{equation*}
Then $\decode-^{\mathcal{S}'}\colon\N\ra \mathcal{S}'$
is a surjection.
Given~$k\in \N$ with $k\equiv \left<a_1\dotsb a_K\right>$, let
\begin{equation*}
 \decode{k}^{\mathcal{S}_\cap'}
\ \eqdf\ 
\decode{a_1}^{\mathcal{S}'} \,\cap\,\dotsb\,\cap\,\decode{a_K}^{\mathcal{S}'}.
\end{equation*}
Then $\decode-^{\mathcal{S}_\cap'}\colon \N\ra {\mathcal{S}_\cap'}$
is a surjection.
Given~$k\in \N$ with $k\equiv \left<a_1\dotsb a_K\right>$, let
\begin{equation*}
 \decode{k}^{\mathcal{A}}
\ \eqdf\ 
\decode{a_1}^{\mathcal{S}_\cap'} \,\cup\,
   \dotsb\,\cup\,\decode{a_K}^{\mathcal{S}_\cap'}.
\end{equation*}
Then $\decode-^{\mathcal{A}}\colon \N\ra {\mathcal{A}}$
is a surjection.

Let $A\in \mathcal{A}$ be given.
If
$\decode{k}^\mathcal{A}=A$
for some 
 $k\in \N$ 
we say
that~$k$ is a \emph{code} for~$A$.
Note that~$A$ might have multiple codes.
This will not be a problem.

\subsubsection{Encoding Countable Ordinal Numbers}$\,$\\
Before we can make the step
to encode all Borel subsets of~$\N^\N$
we need an encoding for
the countable ordinal numbers.
We need some notation.
\begin{nt}
Let $f\in\N^\N$
and $n\in \N$ be given.
Define $f^{[n]}\in \N^\N$ by, for $m\in\N$,
\begin{equation*}
f^{[n]} (m) \ =\ f(\,\left<n,m\right>\,).
\end{equation*}
\end{nt}
Since $\left< -,-\right>$
is a bijection from~$\N\times\N$
to $\N\backslash\{1\}$,
an element $f\in\N^\N$
is completely determined
by $f^{[1]},f^{[2]},\dotsc$
\emph{and}~$f(1)$.
More precisely,
the assignment
\begin{equation*}
f\quad\mapsto\quad
 f(1),\ f^{[1]},\  f^{[2]},\ \dotsc.
\end{equation*}
gives a bijection from
$\N^\N$ to $\N \times (\N^\N)^\N$.

To encode the countable ordinal numbers,
we use special elements of~$\N^\N$.
\begin{dfn}
\label{D:bhier-stump}
Let~$\Stump$ be the subset  of~$\N^\N$
inductively given by:
\begin{enumerate}
\item
If $f\in\N^\N$ and $f(1)\neq 1$, then $f\in \Stump$.

\item
If $f\in\N^\N$
and $f(1)=1$
and $f^{[n]}\in\Stump$ for all~$n\in\N$,
then $f\in \Stump$.
\end{enumerate}
The elements of~$\Stump$
are called \keyword{stumps}
and are used in Intuitionistic Mathematics
as a replacement for the countable ordinal numbers.
\end{dfn}
\begin{dfn}
\label{D:bhier-alpha}
Let $\alpha[-]\colon \Stump \ra \aleph_1$
be the map recursively defined by
\begin{equation*}
\alpha[f]\ =\ 
\begin{cases}
\ 0&
\text{if $f(1)\neq1$;}\\
\ \bv_{n\in \N}\ \alpha[f^{[n]}]+1&
\text{if $f(1)= 1$.}
\end{cases}
\end{equation*}
Recall that~$\aleph_1$
is the set of all countable ordinal numbers.
\end{dfn}

\begin{lem}
The map $\alpha[-]\colon \Stump\longrightarrow \aleph_1$ is surjective.
\end{lem}
\begin{proof}
To prove that $\alpha[-]$ is surjective,
we must 
show that
for each~$\alpha\in\aleph_1$
there is an~$f\in \Stump$ with $\alpha[f]=\alpha$.
We use induction on~$\alpha\in\aleph_1$.

First we must find an~$f\in\Stump$
with $\alpha[f]=0$.
Simply take the $f \in \N^\N$
with $f(n)=37$ for all~$n\in \N$.
Then $f(1)\neq 0$, so~$f\in\Stump$, and $\alpha[f]=0$.

Let $\alpha\in \aleph_1$
be given, 
and assume that $\alpha = \alpha[f]$
for some~$f\in\Stump$.
We need to find a~$g\in \Stump$
such that $\alpha[g]=\alpha+1$.
Define $g\in\N^\N$ by 
\begin{equation*}
g(1)\,=\,1,\qquad\text{and}\qquad
g^{[n]}\,=\, f\quad\text{for all~$n\in\N$}.
\end{equation*}
Then $g\in\Stump$, and $\alpha[g]=\bv_{n\in\N} \ \alpha[f]+1$.
Since $\alpha[f]=\alpha$, we have $\alpha[g]=\alpha+1$.

Let $\lambda\in\aleph_1$
be a limit ordinal,
and assume that $\alpha[-]$ is surjective on~$\lambda$.
We must find an~$f\in \Stump$ such that~$\alpha[f]=\lambda$.
Since $\lambda\in\aleph_1$
there are  $\alpha_1 ,\alpha_2 ,\dotsc \in \lambda$
such that $\lambda = \bv_{n\in\N}\ \alpha_n+1$.
Since $\alpha[-]$
is surjective on~$\lambda$,
we know that there are  $f_1,f_2,\dotsc \in \Stump$
with $\alpha[f_n] = \alpha_n$.
Define $f\in\N^\N$ by 
\begin{equation*}
f(1)\,=\,1\qquad\text{and}\qquad
f^{[n]} \,=\, f_n\quad\text{for all $n\in\N$}.
\end{equation*}
Then $f\in\Stump$,
and $\alpha[f] = \bv_{n\in\N}\  \alpha[f^{[n]}]+1 
= \bv_{n\in\N}\ \alpha_n +1 = \lambda$.
\end{proof}

\subsubsection{Encoding Borel Subsets of~$\N^\N$}$\,$\\
We are now ready to encode the Borel subsets of~$\N^\N$.
\begin{dfn}
With recursion on~$\Stump$
define for each~$f\in\Stump$
maps
\begin{equation*}
\decode{-}^\Pi_f \colon \N^\N \longrightarrow \Pi(\Sigma_{\alpha[f]}\mathcal{A})
\qquad
\text{and}
\qquad
\decode{-}^\Sigma_f \colon \N^\N 
\longrightarrow \Sigma(\Pi_{\alpha[f]}\mathcal{A})
\end{equation*}
such that the following clauses hold.
\begin{enumerate}
\item
For $f\in \Stump$ with $f(1)\neq 1$ we have
\begin{alignat*}{3}
\decode{g}^\Pi_f \ &=\  
\bigcap_{n\geq 2} \ \decode{\,g(n)\,}^\mathcal{A}&
\qquad\text{and}\qquad
\decode{g}^\Sigma_f \ &=\ 
\bigcup_{n\geq 2}\  \decode{\,g(n)\,}^\mathcal{A}.
\end{alignat*}

\item
For $f\in \Stump$ with $f(1)= 1$
we have
\begin{equation*}
\decode{g}^\Pi_f \ =\ 
\bigcap_{n\in\N}\ \decode{\,g^{[n]}\,}^\Sigma_{f^{[n]}}
\qquad\text{and}\qquad
\decode{g}^\Sigma_f \ =\ 
{\bigcup_{n\in\N}}\ \decode{\,g^{[n]}\,}^\Pi_{f^{[n]}}.
\end{equation*}
\end{enumerate}
\end{dfn}
\begin{lem}
For each~$f\in\Stump$
the maps
$\decode{-}^\Pi_f$
and 
$\decode{-}^\Sigma_f$
are surjective.
\end{lem}
\begin{proof}
We leave this to the reader.
\end{proof}
\begin{rem}
\label{R:bhier-g1}
Let $f\in \Stump$
and $g\in \N^\N$ be given.
Note that $\decode{g}^\Pi_f$
and $\decode{g}^\Sigma_f$
do not depend on~$g(1)$.
More precisely,
given $g'\in\N^\N$ 
with $g'(n)=g(n)$ for all~$n\geq 2$
--- so  possibly $g(1) \neq g'(1)$.
Then we have  $\decode{g}^\Pi_f = \decode{g'}^\Pi_f$
and $\decode{g}^\Sigma_f = \decode{g'}^\Sigma_f$.
\end{rem}
We use Remark~\ref{R:bhier-g1}
to combine the maps~$\decode{-}^\Pi_f$
and $\decode{-}^\Sigma_f$
into one map~$\decode{-}^\mathcal{B}_f$.
\begin{dfn}
Let
$\decode{-}^{\mathcal{B}}_{-}\colon 
  \N^\N\times \Stump \longrightarrow \mathcal{B}$
be given by, for $f\in\Stump$ and~$g\in\N^\N$,
\begin{equation}
\label{eq:decode-Borel}
\decode{g}^{\mathcal{B}}_f \ = \ 
\begin{cases}
\  \decode{g}^{\Pi}_f  \quad
& \text{if $g(1)= 37$},\\

\ \decode{g}^{\Sigma}_f
& \text{if $g(1)\neq 37$}.
\end{cases}
\end{equation}
\end{dfn}
We want to prove that $\decode{-}_{-}^\mathcal{B}$
is surjective. 
To do this,
we need a lemma.
\begin{lem}
\label{L:Borel-aleph1}
We have the following equality.
\begin{equation}
\label{eq:Borel-aleph1}
\mathcal{B} \ =\  \Pi_{\aleph_1} \mathcal{A}.
\end{equation}
\end{lem}
\begin{proof}
Note that we have already proven 
(at the end of
in Subsection~\ref{SS:hierarchy})
 that $\mathcal{B} = \Pi_\xi \mathcal{A}$
for \emph{some} ordinal number~$\xi$.
Statement~\eqref{eq:Borel-aleph1}
is an improvement.

Recall that $\Pi_{\aleph_1}\mathcal{A}
\equiv \bigcup_{\alpha\in\aleph_1} \Pi_\alpha \mathcal{A}$.
Since $\Pi \mathcal{A} \subseteq \Sigma_2 \mathcal{A}$,
we have
\begin{equation*}
\mathcal{T} \ \equiv\  \Sigma \mathcal{A} 
\ \subseteq\  \Pi_{\aleph_1}\mathcal{A}\ \subseteq\ \mathcal{B}.
\end{equation*}
Recall that~$\mathcal{B}$
is the family of all subsets of~$\N^\N$
that can be formed using countable unions and countable intersections
starting from~$\mathcal{T}$.
So to prove that $\Pi_{\aleph_1}\mathcal{A} = \mathcal{B}$
it suffices
to show that~$\Pi_{\aleph_1}\mathcal{A}$
is `closed' under countable unions and  intersections,
i.e.,
given $A_1,A_2,\dotsc \in \Pi_{\aleph_1}\mathcal{A}$
we must show that  $\bigcup_n A_n \in \Pi_{\aleph_1}\mathcal{A}$
and  $\bigcap_n A_n \in \Pi_{\aleph_1}\mathcal{A}$.
We will only prove that~$\bigcup_n A_n \in \Pi_{\aleph_1}\mathcal{A}$;
the proof of~$\bigcap_n A_n \in \Pi_{\aleph_1}\mathcal{A}$
is similar.

Let $A_n' \eqdf A_1 \cup \dotsb \cup A_n$
for each~$n\in\N$.
Then $\bigcup_n A_n' = \bigcup_n A_n$.
Since $\Pi_{\aleph_1}\mathcal{A}$
is a sublattice of~$\wp(\N^\N)$,
we get that 
$A_n'\in \Pi_{\aleph_1}\mathcal{A}
\equiv\bigcup_{\alpha\in\aleph_1}\Pi_{\alpha}\mathcal{A}$
for all~$n\in\N$.

Pick $\alpha_1,\alpha_2,\dotsc \in \aleph_1$
such that $A_n' \in \Pi_{\alpha_n} \mathcal{A}$
for all~$n\in\N$.
Let $\alpha\eqdf \bigvee_n \alpha_n$.
Then 
for all~$n\in\N$ we have $\alpha_n \leq \alpha$,
and  $\Pi_{\alpha_n} \mathcal{A} \subseteq \Pi_{\alpha}\mathcal{A}$,
and so $A_n'\in\Pi_{\alpha}\mathcal{A}$.
By definition of 
$ \Sigma(\Pi_{\alpha}\mathcal{A})$
we have $\bigcup_n A_n' \,\in\,
\Sigma(\Pi_{\alpha}\mathcal{A})\equiv\Sigma_{\alpha+1}\mathcal{A}$.
Now, note that since $\alpha_1,\alpha_2,\dotsc \in\aleph_1$,
also $\alpha=\bigvee_n \alpha_n \in \aleph_1$,
and so $\alpha+1 \in\aleph_1$.
Hence 
\begin{equation*}
\textstyle{\bigcup_n A_n \,=\,  \bigcup_n A_n' 
\ \in\  \Pi_{\alpha+1}\mathcal{A}
\,\subseteq\, \Pi_{\aleph_1}\mathcal{A}.}
\end{equation*}
So $\Pi_{\aleph_1} \mathcal{A}$
is closed under countable union.
Similarly, $\Pi_{\aleph_1} \mathcal{A}$
is closed under countable intersection.
It follows that  $\mathcal{B} = \Pi_{\aleph_1}\mathcal{A}$.
We have proven Statement~\eqref{eq:Borel-aleph1}.
\end{proof}

\begin{prop}
The map $\decode{-}^\mathcal{B}_{-}\colon \N^\N\times \Stump
\longrightarrow \mathcal{B}$
is surjective.
\end{prop}
\begin{proof}
Let $A\in\mathcal{B}$ be given.
We must find $f\in\Stump$
and $g\in\N^\N$ such that $A=\decode{g}^{\mathcal{B}}_f$.
By Lemma~\ref{L:Borel-aleph1}
we know that $A\,\in\,\Pi_{\aleph1} \mathcal{A}
\equiv \bigcup_{\alpha\in\aleph_1} \Pi_\alpha\mathcal{A}$.
Pick an~$\alpha\in \aleph_1$ with $A\in \Pi_\alpha \mathcal{A}$.
Since the map $\alpha[-]\colon \Stump \ra \aleph_1$
is a surjection,
there is an $f\in\Stump$
such that $\alpha[f] = \alpha$.
Since the map $\decode{-}^{\Pi}_{f}
\colon \N^\N \longrightarrow \Pi(\Sigma_{\alpha[f]} \mathcal{A})$
is a surjection
and $A\,\in\, \Pi_{\alpha} \mathcal{A}
\equiv \Pi_{\alpha[f]}\mathcal{A}
\subseteq \Pi(\Sigma_{\alpha[f]}\mathcal{A})$,
there is an~$h\in \N^\N$
such that $\decode{h}^{\Pi}_f = A$.

Now, let $g\in\N^\N$ be given by
$g^{[n]} = h^{[n]}$ for all~$n\in\N$
and $g(1)= 37$.
Then
\begin{equation*}
\decode{g}^{\mathcal{B}}_f
\ =\ 
\decode{g}^{\Pi}_f
\ =\ 
\decode{h}^{\Pi}_f
\ =\ 
A.
\end{equation*}
So we see that $\decode{-}^{\mathcal{B}}_{-}
\colon \N^\N\times\Stump\longrightarrow \mathcal{B}$
is surjective.
\end{proof}

\subsubsection{Cataloguing Borel Subsets of~$\N^\N$}$\,$\\
We have encoded the Borel subsets
using elements of~$\N^\N$.
To prove the Borel Hierarchy Theorem
(see Statement~\eqref{eq:hierarchy-theorem})
we use the encoding to go one step further.
\begin{dfn}
For each~$f\in \Stump$,
define 
\begin{alignat*}{3}
U^\Pi_f
\ &=\ 
\{\ h\in\N^\N\colon\   h^{[1]} \in \decode{h^{[2]}}^\Pi_f\ \},&\qquad
U^\Sigma_f
\ &=\ 
\{\ h\in\N^\N\colon\ 
h^{[1]} \in \decode{h^{[2]}}^\Sigma_f \ \}.
\end{alignat*}
\end{dfn}
\noindent
One can think of the set~$\smash{U^\Pi_f}$
as a \emph{catalogue} of~$\smash{\Pi(\Sigma_{\alpha[f]}\mathcal{A}})$.\\
Indeed,
given $A\in \Pi(\Sigma_{\alpha[f]}\mathcal{A})$
with 
$A=\decode{g}^\Pi_f$
for some $g\in\N^\N$,
we have
\begin{equation*}
A \ =\ \{ \ h^{[1]}\colon \ h\in U^\Pi_f \ \text{ and } \ h^{[2]}=g\ \}.
\end{equation*}
The following lemma
might be the essential 
part of the Borel Hierarchy Theorem.
\begin{lem}
\label{L:bhier-lemma}
Let $f\in\Stump$ be given.
Then we have
\begin{equation}
\label{eq:peer-catalogue}
U_f^\Pi \,\in\, \Pi(\Sigma_{\alpha[f]}\mathcal{A})
\qquad\text{and}\qquad
U_f^\Sigma \,\in\, \Sigma(\Pi_{\alpha[f]}\mathcal{A}).
\end{equation}
\end{lem}
To give a proof of Lemma~\ref{L:bhier-lemma}
we need some notation and a lemma.
\begin{dfn}
\label{D:bhier-continuous}
Let $F\colon \N^\N\longrightarrow \N^\N$
be given.
\begin{enumerate}
\item
Given $A\subseteq \N^\N$,
let
$F^*(A)\,\eqdf\,\{\ g\in \N^\N\colon \ F(g)\in A\ \}$.
\item
We say that~$F$ is \keyword{continuous}
if~$F^*(B^m_n) \in \mathcal{T}$
for all~$m,n\in \N$.
\end{enumerate}
\end{dfn}
\begin{lem}
\label{L:bhier-continuous}
Let $F\colon \N^\N\ra \N^\N$ be a continuous function.\\
Let $\alpha$ be an ordinal number with~$\alpha>0$.
Then, for all~$A\subseteq\N^\N$,
\begin{alignat*}{3}
F^*(A) \,&\in\, \Pi_\alpha\mathcal{A}&
\qquad\text{when}\qquad A\,&\in\,\Pi_\alpha\mathcal{A}, \\
F^*(A) \,&\in\, \Sigma_\alpha\mathcal{A}&
\qquad\text{when}\qquad A\,&\in\,\Sigma_\alpha\mathcal{A}.
\end{alignat*}
\end{lem}
\begin{proof}
We leave this to the reader.
\end{proof}


\begin{proof}[Proof of Lemma~\ref{L:bhier-lemma}]
We prove Statement~\eqref{eq:peer-catalogue} using induction 
over~$f\in\Stump$.

\vspace{.6em}
\noindent
Let $f\in\Stump$ with $f(1)\neq1$ be given.
We must prove that
\begin{equation*}
U^\Pi_f \ \in\ \Pi \mathcal{A}
\qquad\text{and}\qquad
U^\Sigma_f \ \in\ \Sigma \mathcal{A}.
\end{equation*}
We will only prove that $U^\Sigma_f \in \Sigma \mathcal{A}$
since the proof of~$U^\Pi_f \in \Pi\mathcal{A}$ is similar.

Let $h\in \N^\N$ be given.
Note that the following are equivalent.
\begin{alignat*}{3}
h \ &\in\ U^\Sigma_f, \\
h^{[1]} \ &\in\ \decode{\,h^{[2]}\,}^\Sigma_f, \\
h^{[1]} \ &\in\ \textstyle{\bigcup_{n\geq 2}}\ 
           \decode{\,h^{[2]}(n)\,}^\mathcal{A}, \\
h^{[1]} \ &\in\ \decode{\,h^{[2]}(n)\,}^\mathcal{A}
\qquad &&\text{for some~$n\geq 2$},\\
h^{[1]} \ &\in\ \decode{k}^\mathcal{A}
\quad\text{and}\quad
h^{[2]}(n)\,=\,k
\qquad &&\text{for some~$n\geq 2$,\  $k\in\N$}.
\end{alignat*}
Let $F\colon \N^\N\ra\N^\N$
be given by $F(g)=g^{[1]}$.
Then $h^{[1]} \in \decode{k}^{\mathcal{A}}$
iff $h\in F^*(\decode{k}^\mathcal{A})$.
Further, note that $h^{[2]}(n)=k$ iff $h\in B^{k}_{\left<2,n\right>}$.
All in all, we get 
\begin{equation}
\label{eq:bhier-Usigmaf0}
U^\Sigma_f
\ =\ 
\bigcup_{k\in\N} \bigcup_{n\geq 2}
\ F^*(\,\decode{k}^\mathcal{A}\,) \ \cap\  B^k_{\left<2,n\right>}.
\end{equation}
By Equation~\eqref{eq:bhier-Usigmaf0}
to prove~$U^\Sigma_f \in\Sigma \mathcal{A}$
it suffices to show 
that~$F^*(\,\decode{k}^\mathcal{A}\,) \in \Sigma\mathcal{A}$.

Since it is not hard to see that~$F$ is continuous
(see Definition~\ref{D:bhier-continuous})
and $\decode{k}^\mathcal{A} \in \Sigma\mathcal{A}$
we get by Lemma~\ref{L:bhier-continuous} that
$F^*(\,\decode{k}^\mathcal{A}\,) \,\in\, \Sigma\mathcal{A}$.
Hence~$U^\Sigma_f \in \Sigma\mathcal{A}$.

\vspace{.6em}
\noindent
Recall that we are proving Statement~\eqref{eq:peer-catalogue}
using induction on~$f\in\Stump$.\\
Let $f\in\Stump$
with $f(1)=1$ be given.
Assume that for all~$n\in\N$,
\begin{equation*}
U^\Pi_{f^{[n]}} \,\in\, \Pi(\Sigma_{\alpha[f^{[n]}]}\mathcal{A})
\qquad\text{and}\qquad
U^\Sigma_{f^{[n]}} \,\in\, \Sigma(\Pi_{\alpha[f^{[n]}]}\mathcal{A}).
\end{equation*}
We must prove that 
$U^\Pi_f \,\in\, \Pi(\Sigma_{\alpha[f]} \mathcal{A})$
and $U^\Sigma_f \,\in\, \Sigma(\Pi_{\alpha[f]} \mathcal{A})$.
We will prove that
\begin{equation}
\label{eq:peer-catalogue-induction}
U^\Sigma_f \,\in\, \Sigma(\Pi_{\alpha[f]} \mathcal{A}),
\end{equation}
and we leave the proof of
$U^\Pi_f \,\in\, \Pi(\Sigma_{\alpha[f]} \mathcal{A})$
to the reader.

To proceed, we need some notation.
We will define a `pairing'
\begin{equation*}
P\colon \N^\N \times \N^\N\longrightarrow \N^\N.
\end{equation*}
Let $h_1,h_2\in\N^\N$ be given.
Define $P(h_1,h_2)\in\N^\N$
by: $P(h_1,h_2)(1) = 1$, and
\begin{equation*}
(\,P(h_1,h_2)\,)^{[1]} \,=\, h_1,
\qquad\text{and}\qquad
(\,P(h_1,h_2)\,)^{[2]} \,=\, h_2,
\end{equation*}
and $(\,P(h_1,h_2)\,)^{[n]}(m) = 1$
for all~$n,m\in\N$ with $n>2$.

Let $h\in\N^\N$ be given.
Note that the following are equivalent.
\begin{alignat*}{3}
h \ &\in\  U^\Sigma_f, \\
h^{[1]} \ &\in\ \decode{\,h^{[2]}\,}^\Sigma_f, \\
h^{[1]} \ &\in\ 
\textstyle{\bigcup_{n\in\N}}\ 
        \decode{\,h^{[2][n]}\,}^\Pi_{f^{n}}, \qquad\\
 h^{[1]} \ &\in\ 
        \decode{\,h^{[2][n]}\,}^\Pi_{f^{n}} 
\qquad&\text{for some $n\in\N$},\\
 P(h^{[1]},h^{[2][n]}) \ &\in\ 
        U^{\Pi}_{f^{[n]}} 
\qquad&\text{for some $n\in\N$}.
\end{alignat*}
Now,
for each~$n\in\N$,
let $F_n\colon \N^\N \ra\N^\N$
be given by, for $h\in\N^\N$,
\begin{equation*}
F_n(h) \ =\  P(h^{[1]},h^{[2][n]}).
\end{equation*}
Then using the notation of Definition~\ref{D:bhier-continuous}
we see that
\begin{equation}
\label{eq:expression-us}
U^\Sigma_f \ =\ 
\textstyle{\bigcup_{n\in\N}} \ F_n^*(\, U^\Pi_{f^{[n]}}\,).
\end{equation}
Recall that we must prove
that $U^\Sigma_f \in \Sigma(\Pi_{\alpha[f]}\mathcal{A})$.
It suffices to prove that
\begin{equation}
\label{eq:hierarchy-theorem-last-step}
F_n^*(\, U^\Pi_{f^{[n]}}\,) \ \in\  \Pi(\Sigma_{\alpha[f^{[n]}]}\mathcal{A}),
\end{equation}
by  Statement~\eqref{eq:expression-us},
and because we have
\begin{equation*}
\Pi(\Sigma_{\alpha[f^{[n]}]}\mathcal{A}) 
\ \subseteq \ \Sigma(\Pi_{\alpha[f]}\mathcal{A}).
\end{equation*}
By Lemma~\ref{L:bhier-continuous}
to prove
that Statement~\eqref{eq:hierarchy-theorem-last-step}
holds
it suffices to show that~$F_n$
is continuous; we leave this to the reader.
Hence we have proven Statement~\eqref{eq:peer-catalogue-induction}.

This completes the proof of Statement~\eqref{eq:peer-catalogue}.
\end{proof}

\subsubsection{Diagonalization}$\,$\\
With the catalogues $U^\Sigma_f$ and $U^\Pi_f$
at our disposal
we use Cantor's diagonal argument
to prove the Borel Hierarchy Theorem
(see Statement~\eqref{eq:hierarchy-theorem}).

Let $f\in\Stump$ be given.
Now, define subsets $D^\Pi_f$
and $D^\Sigma_f$ of $\N^\N$ by
\begin{equation*}
D^\Pi_f \ \eqdf \ 
\{\  g\in\N^\N\colon\ g\notin \decode{g}^\Pi_f\ \},
\qquad
D^\Sigma_f \ \eqdf \ 
\{\  g\in\N^\N\colon\ g\notin \decode{g}^\Sigma_f\ \}.
\end{equation*}
We will prove that~$D^\Pi_f \in \Sigma(\Pi_{\alpha[f]}\mathcal{T})$
and $D^\Pi_f\notin \Pi_{\alpha[f]}\mathcal{T}$.

Let us first prove that $D^\Pi_f\notin \smash{\Pi_{\alpha[f]}} \mathcal{T}$.
Assume $D^\Pi_f \in \Pi_{\alpha[f]}\mathcal{T}$
in order to reach a contradiction.
Since $\decode{-}^\Pi_f$
is surjective,
there is a~$g_\delta \in \N^\N$
with $\decode{g_\delta}^\Pi_f = D^\Pi_f$.
Then
\begin{equation}
\label{eq:diagonalization}
g_\delta \,\in\, D^\Pi_f
\quad\iff\quad
g_\delta \,\notin\, \decode{g_\delta}^\Pi_f = D^\Pi_f
\end{equation}
by Definition of~$D^\Pi_f$.
Statement~\eqref{eq:diagonalization}
leads to a contradiction.
Hence $D^\Pi_f\notin \smash{\Pi_{\alpha[f]}} \mathcal{T}$.


Let us now prove that $D^\Pi_f \in \Sigma (\Pi_{\alpha[f]}\mathcal{T})$.
Let~$\Delta\colon \N^\N \ra \N^\N$
be given by, for $g\in \N^\N$,
\begin{equation*}
\Delta(g) \ =\  P(g,g).
\end{equation*}
Then $\Delta$ is continuous,
and we have, for $g\in \N^\N$,
\begin{equation*}
g\,\in\, D^\Pi_f 
\quad\iff\quad
\Delta(g) \,\notin\, U^\Pi_f
\quad\iff\quad
g\,\in\,\Delta^*(\,\N^\N \backslash U^\Pi_f \,).
\end{equation*}
So we see that $D^\Pi_f = \Delta^*(\,\N^\N\backslash U_f^\Pi\,)$.
Hence to prove that~$D^\Pi_f \in \Sigma(\Pi_{\alpha[f]}\mathcal{T})$
it suffices to show 
that~$\N^\N\backslash U^\Pi_f \,\in\, \Sigma(\Pi_{\alpha[f]}\mathcal{T})$.
Since we have already shown that~$U^\Pi_f \in \Pi_{\alpha[f]}\mathcal{T}$,
we are done if we prove the following statement.









































%
%                  HIERARCHY OF EXTENSIONS
%
\subsection{The Hierarchy of Extensions}
\begin{prop}
\label{P:hier}
Let $\vs{V}{L}{\varphi}{E}$
be a valuation system.

Consider the following `package' of objects.
\begin{enumerate}
\item \label{hier:first-cond}
For each ordinal number~$\alpha$,
statements
\begin{equation*}
\text{``\keyword{$\varphi$ is $\Pi_\alpha$-extendible}''}
\qquad\text{ and }\qquad
\text{``\keyword{$\varphi$ is $\Sigma_\alpha$-extendible}''}.
\end{equation*}
\item
For each~$\alpha$ such that~$\varphi$ 
is $\Pi_\alpha$-extendible,
a valuation system 
\begin{equation*}
\vs{V}{\Pi_\alpha L}{\Pi_\alpha \varphi}{E},
\end{equation*}

\item
and for each~$\alpha$ such that~$\varphi$ is $\Sigma_\alpha$-extendible,
a valuation system 
\begin{equation*}
\vs{V}{\Sigma_\alpha L}{\Sigma_\alpha \varphi}{E}.
\end{equation*}
\end{enumerate}
There is precisely one such package which satisfies
the following conditions.
\begin{enumerate}
\item
$\varphi$ is {$\Pi_0$-extendible}
and $\varphi$ is {$\Sigma_0$-extendible}.
Moreover,
\begin{equation*}
\Pi_0 L = L\qquad 
\Sigma_0 L = L \qquad 
\Pi_0 \varphi = \varphi \qquad
\Sigma_0 \varphi = \varphi.
\end{equation*}

\item
Let $\alpha$ be an ordinal number.
We have 
$\varphi$ is {$\Pi_{\alpha+1}$-extendible}
if and only if $\varphi$ is $\Sigma_{\alpha}$-extendible
and $\Sigma_\alpha \varphi$ is $\Pi$-extendible.
If $\varphi$ is $\Pi_{\alpha+1}$-extendible,
then 
\begin{equation*}
\Pi_{\alpha+1} L = \Pi(\Sigma_\alpha L)\qquad\qquad
\Pi_{\alpha+1} \varphi = \Pi(\Sigma_\alpha \varphi),
\end{equation*}
where 
 $\vs{V}{\Pi(\Sigma_\alpha L)}{\Pi(\Sigma_\alpha\varphi)}{E}$
is the valuation system from Definition~\ref{D:Pi-extendible}.

\item
Let $\alpha$ be an ordinal number.
We have 
$\varphi$ is {$\Sigma_{\alpha+1}$-extendible}
if and only if $\varphi$ is $\Pi_{\alpha}$-extendible
and $\Pi_\alpha \varphi$ is $\Sigma$-extendible.
If $\varphi$ is $\Sigma_{\alpha+1}$-extendible,
then 
\begin{equation*}
\Sigma_{\alpha+1} L = \Sigma(\Pi_\alpha L)\qquad\qquad
\Sigma_{\alpha+1} \varphi = \Sigma(\Pi_\alpha \varphi).
\end{equation*}

\item
Let~$\lambda$ be a limit ordinal.
We have $\varphi$ is {$\Pi_\lambda$-extendible}
if and only if $\varphi$ is $\Pi_\alpha$-extendible
for each~$\alpha < \lambda$.
If $\varphi$ is $\Pi_\lambda$-extendible,
then 
\begin{equation*}
\Pi_\lambda L = \textstyle{\bigcup_{\alpha < \lambda} \Pi_\alpha L}
\qquad\qquad
\Pi_\lambda \varphi (c) = \Pi_\beta \varphi(c),
\end{equation*}
where $\beta < \lambda$ and $c\in \Pi_\beta L$.

\item
\label{hier:last-cond}
Let~$\lambda$ be a limit ordinal.
We have $\varphi$ is {$\Sigma_\lambda$-extendible}
if and only if $\varphi$ is $\Sigma_\alpha$-extendible
for each~$\alpha < \lambda$.
If $\varphi$ is $\Sigma_\lambda$-extendible,
then 
\begin{equation*}
\Sigma_\lambda L = \textstyle{\bigcup_{\alpha < \lambda} \Sigma_\alpha L}
\qquad\qquad
\Sigma_\lambda \varphi (c) = \Sigma_\beta \varphi(c),
\end{equation*}
where $\beta < \lambda$ and $c\in \Sigma_\beta L$.
\end{enumerate}
Moreover,
the hierarchy we obtain has the following form.
\begin{equation*}
\xymatrix @=10pt {
& \Sigma\varphi \ar @{-} [rr] \ar @{-} [rrdd]
&& \Sigma_2 \varphi  \ar @{-} [r]\ar @{-} [rd]
&& \dotsb
& \Sigma_{\omega} \varphi \ar @{-} [r] \ar @{-} [rd]
                          \ar @{=} [dd]
&& \dotsb\ \dotsb
& \Sigma_{\lambda} \varphi \ar @{-} [r] \ar @{-} [rd]
                          \ar @{=} [dd]
&& \dotsb
\\  
\varphi \ar @{-} [ru] \ar @{-} [rd] 
&&&&&\dotsb
&&&\dotsb\ \dotsb
&&&\dotsb\\
& \Pi\varphi \ar @{-} [rr] \ar @{-} [rruu]
&& \Pi_{2} \varphi \ar @{-} [r] \ar @{-} [ru]
&& \dotsb
& \Pi_{\omega}\varphi \ar @{-} [r] \ar @{-} [ru]
&& \dotsb\ \dotsb
& \Pi_{\lambda}\varphi \ar @{-} [r] \ar @{-} [ru]
&& \dotsb
}
\end{equation*}
More precisely, the following statements are true.
\begin{enumerate}[label=(\Roman*)]
\item\label{req:hierarchy-A}
For all $\beta < \gamma$,
if  $\varphi$ is $\Pi_\gamma$-extendible,
then $\varphi$ is both $\Pi_\beta$- and $\Sigma_\beta$-extendible,
and the map $\Pi_\gamma\varphi$ extends 
both $\Pi_\beta\varphi$ and $\Sigma_\beta\varphi$.
\item\label{req:hierarchy-B}
For all $\beta < \gamma$,
if  $\varphi$ is $\Sigma_\gamma$-extendible,
then $\varphi$ is both $\Pi_\beta$- and $\Sigma_\beta$-extendible,
and the map $\Sigma_\gamma\varphi$ extends 
both $\Pi_\beta\varphi$ and $\Sigma_\beta\varphi$.
\item\label{req:hierarchy-C}
Let~$\lambda$
be zero or a a limit ordinal.
Then $\varphi$ is $\Pi_\lambda$-extendible
if and only if $\varphi$ is $\Sigma_\lambda$-extendible.
Furthermore,
if $\varphi$ is $\Pi_\lambda$-extendible,
then $\Pi_\gamma\varphi = \Sigma_\gamma\varphi$.
\end{enumerate}
\end{prop}
\begin{proof}
Straightforward with transfinite induction.
We leave this to the reader.
\end{proof}
%
%                  COLLAPSE
%
\begin{dfn}
\label{D:collapse}
Let $\vs{V}{L}\varphi{E}$ be a valuation system.
\begin{enumerate}
\item
\label{D:collapse-1}
We say the \keyword{hierarchy has collapsed at~$Q$} if
\begin{equation*}
\left[\quad
\begin{minipage}{.7\columnwidth}
$\varphi$ is $\Pi_{\alpha+1}$-extendible
 and $\Sigma_{\alpha+1}$-extendible,
and 
\begin{equation*}
\Pi(Q)\ =\ Q\ =\ \Sigma(Q),
\end{equation*}
where 
$Q=\Pi_\alpha \varphi$
or $Q=\Sigma_\alpha \varphi$.
\end{minipage}
\right.
\end{equation*}

\item
\label{D:collapse-2}
We say the \keyword{hierarchy collapses}
if the hierarchy has collapsed at some~$Q$.
\end{enumerate}
\end{dfn}

\begin{lem}
\label{L:collapse}
Let $\vs{V}{L}\varphi{E}$
be a valuation system.
\begin{enumerate}
\item
\label{L:collapse-1}
Let $\alpha<\beta$ be ordinal numbers.
Suppose the hierarchy has collapsed at~$\Pi_\alpha \varphi$.
Then $\varphi$ is $\Pi_\beta$-extendible and $\Sigma_\beta$-extendible,
and  
\begin{equation*}
\Pi_\beta \varphi \,=\, \Pi_\alpha \varphi \,=\, \Sigma_\beta \varphi.
\end{equation*}
\item
\label{L:collapse-2}
If the hierarchy collapses
at $\Pi_\alpha \varphi$ and at $\Sigma_\alpha\varphi$
for some~$\alpha$,
then $\Pi_\alpha\varphi = \Sigma_\alpha\varphi$.

\item
\label{L:collapse-3}
Suppose the hierarchy has collapsed at~$Q_1$ and at~$Q_2$.
Then $Q_1 = Q_2$.
\item
\label{L:collapse-4}
The hierarchy collapses
if and only if 
it has collapsed at $\Pi_\alpha \varphi$
for some~$\alpha$.
\end{enumerate}
\end{lem}
\begin{proof}
\noindent\ref{L:collapse-1}\ 
Suppose that the hierarchy has collapsed at~$\Pi_\alpha\varphi$
for some~$\alpha$.
We prove with induction on~$\beta$,
that for all~$\beta\geq \alpha$,
we have that
$\varphi$
is $\Pi_\beta$-extendible and $\Sigma_\beta$-extendible,
and that  $\Pi_\beta\varphi = \Pi_\alpha\varphi = \Sigma_\beta \varphi$.

If $\beta=\alpha$, the proposition is trivial.

Suppose $\varphi$ is $\Pi_\beta$-extendible
and $\Sigma_\beta$-extendible,
and that $\Pi_\beta\varphi = \Pi_\alpha\varphi = \Sigma_\beta \varphi$,
for some~$\beta$.
Since the hierarchy has collapsed at $\Pi_\alpha\varphi$,
we know that~$\varphi$ is $\Sigma_{\alpha+1}$-extendible.
(Hence $\Pi_\alpha \varphi = \Pi_\beta\varphi$
is $\Sigma$-extendible,
and so $\varphi$ is $\Sigma_{\beta+1}$-extendible.)
Moreover, we know that $\Sigma(\Pi_\alpha\varphi)=\Pi_\alpha\varphi$.
Hence  
\begin{equation*}
\Sigma_{\beta+1} \varphi \,=\, \Sigma(\Pi_\beta \varphi)
\,=\, \Sigma(\Pi_\alpha\varphi) \,=\, \Pi_\alpha\varphi.
\end{equation*}
Similarly, $\Pi_{\beta+1} \varphi = \Pi_\alpha\varphi$.

Suppose $\lambda > \alpha$ is a limit ordinal
and assume that
for all~$\beta<\lambda$ with $\alpha\leq\beta$,
$\varphi$ is $\Pi_\beta$-extendible
and $\Sigma_\beta$-extendible,
and $\Pi_\beta\varphi = \Pi_\alpha\varphi = \Sigma_\beta\varphi$.
We need to prove that $\varphi$ is $\Pi_\lambda$-extendible
and that $\Pi_\lambda \varphi = \Pi_\alpha \varphi$
(since $\Pi_\lambda \varphi = \Sigma_\lambda\varphi$).

Let $\beta<\lambda$ be given.
In order to prove that $\varphi$ is $\Pi_\lambda$-extendible,
we must show that~$\varphi$ is $\Pi_\beta$-extendible 
(see Proposition~\ref{P:hier}).
If $\beta\geq \alpha$,
then we know that $\varphi$ is $\Pi_\beta$-extendible by assumption.
If $\beta< \alpha$,
then we know that $\varphi$ is $\Pi_\beta$-extendible,
because $\varphi$ is $\Pi_\alpha$-extendible and $\alpha> \beta$
(see Proposition~\ref{P:hier}).

It remains to be show that $\Pi_\lambda \varphi = \Pi_\alpha \varphi$.
To this end, note that
\begin{equation*}
\Pi_\lambda L \ =\  \textstyle{\bigcup_{\beta<\lambda} \Pi_\beta L}
\ =\  \textstyle{\bigcup_{\alpha\leq\beta<\lambda} \Pi_\beta L }
\ =\  \textstyle{\bigcup_{\alpha\leq\beta<\lambda} \Pi_\alpha L }
\ =\  \Pi_\alpha L.
\end{equation*}
Since we already know that $\Pi_\lambda \varphi$
extends $\Pi_\alpha \varphi$,
this implies $\Pi_\alpha \varphi = \Pi_\lambda\varphi$.

\noindent\ref{L:collapse-2}.\ 
We know that $\Sigma_{\alpha+1}\varphi$ extends $\Sigma_\alpha\varphi$,
and that $\Sigma_{\alpha+1}\varphi=\Sigma(\Pi_\alpha\varphi)=\Pi_\alpha\varphi$
since the hierarchy has collapsed at $\Pi_\alpha\varphi$.
Hence $\Pi_\alpha\varphi$ extends $\Sigma_\alpha\varphi$.
With a similar reasoning
we see that $\Sigma_\alpha\varphi$ extends $\Pi_\alpha\varphi$.
Hence $\Pi_\alpha\varphi = \Sigma_\alpha\varphi$.

\noindent\ref{L:collapse-3}.\ 
Suppose the hierarchy has collapsed at~$Q_1$ and~$Q_2$.
We prove $Q_1 = Q_2$.

There is an~$\alpha$ such that  $Q_1 = \Pi_\alpha \varphi$
or $Q_1 = \Sigma_\alpha\varphi$,
and there is a~$\beta$ with 
$Q_2 = \Pi_\beta \varphi$ or $Q_2 = \Sigma_\beta \varphi$.
Without loss of generality, assume $\alpha \leq \beta$.

If $\alpha < \beta$, then we get $Q_1 = Q_2$ by~\ref{L:collapse-1}.
If $\alpha=\beta$, we get $Q_1 = Q_2$ by~\ref{L:collapse-2}.

\noindent\ref{L:collapse-4}.\ 
Suppose the hierarchy collapses.
We need to prove that the hierarchy has collapsed at some $\Pi_\alpha \varphi$.
Since the hierarchy collapses,
we know that the hierarchy has collapsed 
at some $\Pi_\alpha \varphi$ or at some $\Sigma_\alpha\varphi$.
In the former case, we are done.
In the latter case, $\Pi_{\alpha+1} \varphi = \Pi(\Sigma_\alpha \varphi)
= \Sigma_\alpha\varphi$,
so the hierarchy has collapsed at~$\Pi_{\alpha+1}\varphi$.
\end{proof}
%
%                  DEFINITION OF EXTENDIBLE
%
\begin{dfn}
\label{D:extendible}
Let $\vs{V}{L}\varphi{E}$ be a valuation system.
\begin{enumerate}
\item
\label{D:extendible-1}
We say that~$\varphi$ (or  $\vs{V}{L}\varphi{E}$) is \keyword{extendible}
if the hierarchy collapses.

\item
\label{D:extendible-2}
Suppose that $\varphi$ is extendible.
Then there is precisely one valuation
at which the hierarchy has collapsed
(see Lemma~\ref{L:collapse}\ref{L:collapse-3});
we denote it by
\begin{equation*}
\vs{V}{\overline L}{\overline\varphi}{E}.
\end{equation*}
\end{enumerate}
\end{dfn}
%
%                  OVERLINE VARPHI IS COMPLETE
%
\begin{lem}
\label{L:complete}
Let $\vs{V}{L}\varphi{E}$ be an extendible valuation system.
Then
\begin{equation*}
\vs{V}{\overline L}{\overline\varphi}{E}
\text{ is complete.}
\end{equation*}
\end{lem}
\begin{proof}
To prove that~$\overline\varphi$ is complete,
it suffices to show that~$\overline\varphi$
is $\Pi$-complete and $\Sigma$-complete.
We know that $\overline\varphi = \Pi\overline\varphi$
(since the hierarchy has collapsed at~$\overline\varphi$,
see Definition~\ref{D:extendible}\ref{D:extendible-2}
and Definition~\ref{D:collapse}\ref{D:collapse-1}),
and that $\Pi\overline\varphi$ is $\Pi$-complete
(see Lemma~\ref{L:Pi-complete}).
Hence $\overline\varphi$ is $\Pi$-complete.
Similarly,
$\overline\varphi$ is $\Sigma$-complete.
\end{proof}
%
%                  EXTENDIBLE IFF PI_ALEPH_1 EXTENDIBLE
%
\begin{lem}
\label{L:aleph1}
Let $\vs{V}{L}\varphi{E}$ be a valuation system.\\
If $\varphi$ is $\Pi_{\aleph_1}$-extendible,
then the hierarchy has collapsed at $\Pi_{\aleph_1}\varphi$.
\end{lem}
\begin{proof}
Suppose $\varphi$ is $\Pi_{\aleph_1}$-extendible.
We need to prove that the hierarchy has collapsed at~$\Pi_{\aleph_1}\varphi$.
For this, we must show that
(see Definition~\ref{D:collapse}\ref{D:collapse-1}),
\begin{equation*}
\Pi(\Pi_{\aleph_1}\varphi)
= \Pi_{\aleph_1}\varphi = \Sigma(\Pi_{\aleph_1}\varphi).
\end{equation*}

Let $a_1 \geq a_2 \geq \dotsb$ 
be a $\Pi_{\aleph_1}\varphi$-convergent sequence.
In order to show that $\Pi(\Pi_{\aleph_1}\varphi)=\Pi_{\aleph_1}\varphi$,
it suffices to prove that $\bw_n a_n \in \Pi_{\aleph_1}\varphi$.

Since $\aleph_1$ is a limit ordinal,
we know that $\Pi_{\aleph_1} L = \bigcup_{\alpha < \aleph_1} \Pi_\alpha L$
(see Proposition~\ref{P:hier}).
Define
\begin{equation*}
\alpha(n)\ \eqdf\ 
\min\,\{\, \alpha<\aleph_1\colon\, a_n \in \Pi_\alpha L\,\}
\end{equation*}
for every~$n$.
Now,
the set $\{\,\alpha(1),\,\alpha(2),\,\dotsc\,\}$ of
ordinals has a supremum,
\begin{equation*}
\xi\,\eqdf\,\bv_n\alpha(n).
\end{equation*}
Since~$\aleph_1$ is the smallest uncountable ordinal,
and $\alpha(n)<\aleph_1$,
we know that all~$\alpha(n)$ are countable.
Hence~$\xi$ is countable as well,
and so $\xi<\aleph_1$.

Now, we have $a_n \in \Pi_{\xi} L$
for all~$n\in \N$.  Hence
\begin{equation*}
\bw_n a_n \in \Pi(\Pi_{\xi} L) 
\ =\ \Pi_{\xi+1} L
\ \subseteq\ \Pi_{\aleph_1} L.\qedhere
\end{equation*}
\end{proof}
%
%
%
\begin{cor}
\label{C:aleph1}
Let $\vs{V}{L}\varphi{E}$ be a valuation system. Then
\begin{equation*}
\varphi\text{ is extendible }
\quad\iff\quad
\varphi\text{ is $\Pi_{\aleph_1}$-extendible.}
\end{equation*}
Moreover,
if $\varphi$ is extendible,
then $\overline\varphi = \Pi_{\aleph_1}\varphi$.
\end{cor}
\begin{proof}
Assume $\varphi$ is extendible
in order to show that $\varphi$ is $\Pi_{\aleph_1}$-extendible.
Then we know that the hierarchy collapses 
(see Definition~\ref{D:collapse}\ref{D:collapse-2}).
So it collapsed at some~$\Pi_\alpha \varphi$
(see Lemma~\ref{L:collapse}\ref{L:collapse-4}).
Pick an ordinal number~$\beta$ with $\beta > \alpha$
and $\beta > \aleph_1$.
Then $\varphi$ is $\Pi_\beta$-extendible
by Lemma~\ref{L:collapse}\ref{L:collapse-1}.
But $\aleph_1 <\beta$,
so $\varphi$ is also $\Pi_{\aleph_1}$-extendible.

Suppose $\varphi$ is $\Pi_{\aleph_1}$-extendible.
Then the hierarchy has collapsed at~$\Pi_{\aleph_1}$
by Lemma~\ref{L:aleph1}.
Hence 
$\varphi$ is extendible
and  $\overline\varphi = \Pi_{\aleph_1}\varphi$
(see Definition~\ref{D:extendible}\ref{D:extendible-2}).
\end{proof}

%
%                  Pi_\alpha is  MONOTONOUS
%
\begin{lem}
\label{L:alpha-monotonous}
Let $\vs{V}{L}\varphi{E}$
and $\vs{V}{C}\psi{E}$
 be a valuation systems.\\
Assume 
$\psi$ extends $\varphi$.
Then for every ordinal number $\alpha$, we have
\begin{alignat*}{3}
\text{$\psi$ is $\Pi_\alpha$-extendible}
\quad&\implies\quad
\text{$\varphi$ is $\Pi_\alpha$-extendible}
\quad&&\text{and}\quad
\text{$\Pi_\alpha\psi$ }&&\text{extends $\Pi_\alpha\varphi$} \\
\text{$\psi$ is $\Sigma_\alpha$-extendible}
\quad&\implies\quad
\text{$\varphi$ is $\Sigma_\alpha$-extendible}
\quad&&\text{and}\quad
\text{$\Sigma_\alpha\psi$ }&&\text{extends $\Sigma_\alpha\varphi$.}
\end{alignat*}
\end{lem}
\begin{proof}
We prove this lemma using induction on~$\alpha$.

\noindent\emph{(Zero)} For~$\alpha=0$, the proposition is trivial.

\noindent\emph{(Successor)} Let~$\alpha$ be an ordinal number such that
if $\psi$ is $\Sigma_\alpha$-extendible,
then
$\varphi$ is $\Sigma_\alpha$-extendible 
and $\Sigma_\alpha\psi$ extends $\Sigma_\alpha\varphi$.
Suppose~$\psi$
is $\Pi_{\alpha+1}$-extendible.
We prove
\begin{equation}
\label{eq:P:extension-1}
\text{ $\varphi$ is $\Pi_{\alpha+1}$-extendible}
\qquad\text{and}\qquad
\text{ $\Pi_{\alpha+1}\psi$ extends $\Pi_{\alpha+1}\varphi$.}
\end{equation}
Since $\psi$ is $\Pi_{\alpha+1}$-extendible,
we know that
\begin{equation*}
\text{ $\psi$ is $\Sigma_\alpha$-extendible}
\qquad\text{and}\qquad
\text{$\Sigma_\alpha\psi$ is~$\Pi$-extendible}.
\end{equation*}
By assumption, 
the former implies that $\varphi$ is $\Sigma_\alpha$-extendible
and $\Sigma_\alpha\psi$ extends $\Pi_\alpha\psi$;
by Lemma~\ref{L:Pi-monotonous},
the latter implies $\Sigma_\alpha\varphi$
is $\Pi$-extendible
and $\Pi(\Sigma_\alpha\psi)$ extends $\Pi(\Sigma_\alpha \varphi)$.
In other words,
we have proven Statement~\eqref{eq:P:extension-1}.

\noindent\emph{(Limit)}
Let $\lambda$ be a limit ordinal such that
for all $\alpha<\lambda$, we have
\begin{equation*}
\text{$\psi$ is $\Pi_\alpha$-extendible}
\quad\implies\quad
\text{$\varphi$ is $\Pi_\alpha$-extendible }
\quad\text{and}\quad
\text{$\Pi_\alpha\psi$ extends $\Pi_\alpha\varphi$.}
\end{equation*}
Further, 
assume $\psi$ is~$\Pi_\lambda$-extendible
in order to prove that
\begin{equation}
\label{eq:P:extension-2}
\text{ $\varphi$ is $\Pi_{\lambda}$-extendible}
\qquad\text{and}\qquad
\text{ $\Pi_{\lambda}\psi$ extends $\Pi_{\lambda}\varphi$.}
\end{equation}
Let $\alpha <\lambda$ be given.
Since $\psi$ is $\Pi_\lambda$-extendible,
we know that $\psi$ is $\Pi_\alpha$-extendible.
So by assumption, 
$\varphi$ is $\Pi_\alpha$-extendible,
and $\Pi_\alpha \psi$ extends $\Pi_\alpha \varphi$.

So we see that $\varphi$ is $\Pi_\lambda$-extendible.
Further
(since $\Pi_\lambda\psi$ extends $\Pi_\alpha \psi$),
we see that $\Pi_\lambda \psi$ extends all $\Pi_\alpha\varphi$.
Hence $\Pi_\lambda \psi$ extends $\Pi_\lambda \varphi$.
So we have proven~\eqref{eq:P:extension-2}.
\end{proof}
%
%                  OVERLINE PHI IS MONOTONOUS
%
\begin{prop}
\label{P:comp-monotonous}
Let $\vs{V}{L}\varphi{E}$
and $\vs{V}{C}\psi{E}$
 be a valuation systems.\\
Assume 
$\psi$ extends $\varphi$,
and 
$\psi$ is extendible.
Then 
\begin{alignat*}{3}
\text{$\varphi$ is extendible}
\qquad&&\text{and}\qquad
\text{$\overline\psi$ }&&\text{extends $\overline\varphi$}.
\end{alignat*}
\end{prop}
\begin{proof}
By Corollary~\ref{C:aleph1},
we get the conclusion from
Lemma~\ref{L:alpha-monotonous}
with $\alpha=\aleph_1$.
\end{proof}
%
%                  OVERLINE PHI IS MINIMAL
%
\begin{prop}
\label{P:comp-minimal}
Let $\vs{V}{L}\varphi{E}$
and $\vs{V}{C}\psi{E}$
 be a valuation systems.\\
Assume 
$\psi$ extends $\varphi$
and $\psi$ is complete.
Then 
\begin{alignat*}{3}
\text{$\varphi$ is extendible}
\qquad&&\text{and}\qquad
\text{$\psi$ }&&\text{extends $\overline\varphi$}.
\end{alignat*}
\end{prop}
\begin{proof}
Since~$\psi$ is complete,
$\psi$ is clearly extendible 
and $\overline\psi = \psi$.
(Indeed, the hierarchy (of~$\psi$) has already collapsed at~$\psi$ itself,
see Definition~\ref{D:extendible}.)
Hence $\varphi$ is extendible
and $\psi=\overline\psi$ extends $\overline\varphi$
by Proposition~\ref{P:comp-monotonous}.
\end{proof}
\end{document}
